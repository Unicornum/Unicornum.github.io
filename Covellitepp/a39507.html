<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-151583584-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'UA-151583584-1');
    </script>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=9" />
    <meta name="generator" content="Doxygen 1.12.0" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Covellite++: Пользовательский константный буфер</title>
    <link href="tabs.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Title.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Covellite++
   &#160;<span id="projectnumber">Version: 2.3.0 Revision: ??? Platform: x64 Build: 22:59 01.12.2024</span>
   </div>
   <div id="projectbrief">Кроссплатформенный фреймворк для разработки приложений на С++</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Создано системой Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Поиск',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('a39507.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Загрузка...</div>
<div class="SRStatus" id="Searching">Поиск...</div>
<div class="SRStatus" id="NoMatches">Не найдено</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Пользовательский константный буфер</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Пользовательский константный буфер </h1>
<p>Фреймворк предоставляет возможность создания константного буфера для передачи данных шейдеру любого размера и структуры.</p>
<p>Для его использования необходимо:</p><ul>
<li>В шейдере и коде объявить требуемую структуру (ее имя может быть любым).</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">struct </span>UserPointLights</div>
<div class="line">{</div>
<div class="line">  Point_t Lights[8];</div>
<div class="line">  <span class="keywordtype">int</span>     UsedSlotCount;</div>
<div class="line">};</div>
</div><!-- fragment --><ul>
<li>В шейдере объявить константный буфер:<ul>
<li>Имя структуры (UserPointLights) должно соответствовать объявлению.</li>
<li>Имя объявления константного буфера (cbPointLights) - может быть любым и передается как параметр <b>name</b> компонента константного буфера.</li>
<li>Имя объекта константного буфера (PointLights) - может быть любым.</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line">COVELLITE_DECLARE_CONST_USER_BUFFER(UserPointLights, cbPointLights, PointLights);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Далее можно использовать данные из PointLights</span></div>
<div class="line"><span class="keywordflow">if</span> (PointLights.UsedSlotCount &gt; 0)</div>
<div class="line">{</div>
<div class="line">  ...</div>
</div><!-- fragment --><ul>
<li>В нужное место добавить компонент константного буфера:</li>
</ul>
<div class="fragment"><div class="line">UserPointLights PointLights;</div>
<div class="line"> </div>
<div class="line">const ::covellite::api::cbBufferMap_t&lt;void&gt; Mapper = [=](<span class="keywordtype">void</span> * _pData)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Заполнить структуру PointLights</span></div>
<div class="line">  <span class="comment">// ...</span></div>
<div class="line"> </div>
<div class="line">  memcpy(_pData, &amp;PointLights, <span class="keyword">sizeof</span>(PointLights));</div>
<div class="line">  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keyword">auto</span> pUserConstBuffer = Component_t::Make(</div>
<div class="line">{</div>
<div class="line">  { uT(<span class="stringliteral">&quot;id&quot;</span>), Id },</div>
<div class="line">  { uT(<span class="stringliteral">&quot;type&quot;</span>), uT(<span class="stringliteral">&quot;Buffer&quot;</span>) },</div>
<div class="line">  { uT(<span class="stringliteral">&quot;mapper&quot;</span>), Mapper },</div>
<div class="line">  { uT(<span class="stringliteral">&quot;name&quot;</span>), uT(<span class="stringliteral">&quot;cbPointLights&quot;</span>) },</div>
<div class="line">  { uT(<span class="stringliteral">&quot;size&quot;</span>), <span class="keyword">sizeof</span>(UserPointLights) },</div>
<div class="line">});</div>
</div><!-- fragment --><dl class="section note"><dt>Заметки</dt><dd><ul>
<li>Структура должна состоять из элементов, размер каждого из которых кратен 16 байтам.</li>
<li>Следует учитывать, что оверхед от передачи константного буфера шейдеру прямо зависит от размера структуры, поэтому передача больших объемов данных (десятки килобайт) каждому объекту заметно ударит по производительности. Рекомендуется использовать такой буфер либо для передачи каждому объекту данных небольшого размера, либо данных большого размера однократно для сцены (например, таким образом можно передавать данные обо всех точечных источниках света сцены при использовании инстансинга). </li>
</ul>
</dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Документация по Covellite++. Последние изменения: Вс 1 Дек 2024 22:59:57. Создано системой <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
